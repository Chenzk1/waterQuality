<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.project.system.mapper.DataManageMapper">

    <resultMap type="DataManage" id="DataManageResult">
        <id     property="waterId"       column="water_id"        />
        <result property="waterName"     column="water_name"      />
        <result property="photoTime"     column="photo_time"      />
        <result property="country"       column="country"      />
        <result property="province"      column="province"      />
        <result property="city"          column="city"     />
        <result property="type"          column="type"         />
        <result property="bands"        column="bands"       />
        <result property="createBy"     column="create_by"      />
        <result property="createTime"   column="create_time"    />
        <result property="updateBy"     column="update_by"      />
        <result property="updateTime"   column="update_time"    />
        <result property="filePath"       column="file_path"         />
<!--        <result property="fileName"       column="file_name"         />-->
<!--        <result property="rgbPath"       column="rgb_path"         />-->
    </resultMap>

    <sql id="selectDataVo">
	    select distinct r.water_id, r.water_name, r.photo_time, r.country, r.province,
            r.city, r.type, r.bands, r.create_by, r.create_time, r.update_by, r.update_time,
            r.file_path
        from water_info r
    </sql>

    <select id="selectDataList" parameterType="DataManage" resultMap="DataManageResult">
        <include refid="selectDataVo"/>
        where r.del_flag = '0'
        <if test="type != null and type != ''">
            AND r.type = #{type}
        </if>
        <if test="waterName != null and waterName != ''">
            AND r.water_name like concat('%', #{waterName}, '%')
        </if>
        <if test="waterId != null and waterId != ''">
            AND r.water_id = #{waterId}
        </if>

        <if test="params.beginTime != null and params.beginTime != ''"><!-- 开始时间检索 -->
            and date_format(r.photo_time,'%y%m%d') &gt;= date_format(#{params.beginTime},'%y%m%d')
        </if>
        <if test="params.endTime != null and params.endTime != ''"><!-- 结束时间检索 -->
            and date_format(r.photo_time,'%y%m%d') &lt;= date_format(#{params.endTime},'%y%m%d')
        </if>
<!--        &lt;!&ndash; 数据范围过滤 &ndash;&gt;-->
<!--        ${dataScope}-->
    </select>


</mapper>